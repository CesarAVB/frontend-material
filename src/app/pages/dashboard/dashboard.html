<!-- src/app/pages/dashboard/dashboard.component.html -->
<app-header 
  titulo="Dashboard" 
  subtitulo="Visão geral do sistema e indicadores de performance.">
</app-header>

<div class="dashboard-content">
  <!-- Cards de Métricas -->
  @if (metricas()) {
    <div class="stats-grid">
      <app-stats-card
        title="Total de Clientes"
        [value]="metricas()!.totalClientes"
        [change]="getStatsChange(metricas()!.variacao)"
        subtitle="Em relação ao mês anterior"
        icon="people">
      </app-stats-card>

      <app-stats-card
        title="Novos Hoje"
        [value]="metricas()!.novosHoje"
        [change]="getStatsChange(metricas()!.mediaDiaria)"
        [subtitle]="'Média diária: ' + metricas()!.mediaDiaria"
        icon="trending_up">
      </app-stats-card>
    </div>
  }

  <!-- Acesso Rápido -->
  <div class="quick-access-section">
    <h2 class="section-title">Acesso Rápido</h2>
    <div class="quick-access-grid">
      <mat-card class="quick-card" (click)="navegarPara('/cadastro')">
        <mat-card-content>
          <mat-icon>person_add</mat-icon>
          <h3>Novo Cadastro</h3>
          <p>Adicione um novo cliente ao banco de dados</p>
        </mat-card-content>
      </mat-card>

      <mat-card class="quick-card" (click)="navegarPara('/clientes')">
        <mat-card-content>
          <mat-icon>search</mat-icon>
          <h3>Buscar Cliente</h3>
          <p>Encontre informações detalhadas</p>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <!-- Clientes Recentes -->
  <mat-card class="table-card">
    <mat-card-header>
      <mat-card-title>Clientes Recentes</mat-card-title>
      <button mat-button color="primary" routerLink="/clientes">Ver todos</button>
    </mat-card-header>
    
    <mat-card-content>
      @if (!carregando() && clientesRecentes().length > 0) {
        <table mat-table [dataSource]="clientesRecentes()" class="clients-table">
          <ng-container matColumnDef="nome">
            <th mat-header-cell *matHeaderCellDef>Nome</th>
            <td mat-cell *matCellDef="let cliente">
              <div class="cliente-info">
                <app-avatar [name]="cliente.nome" size="md"></app-avatar>
                <span>{{ cliente.nome }}</span>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef>Email</th>
            <td mat-cell *matCellDef="let cliente">{{ getEmail(cliente) }}</td>
          </ng-container>

          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef>Status</th>
            <td mat-cell *matCellDef="let cliente">
              <app-status-badge [status]="'ativo'"></app-status-badge>
            </td>
          </ng-container>

          <ng-container matColumnDef="data">
            <th mat-header-cell *matHeaderCellDef>Data de Cadastro</th>
            <td mat-cell *matCellDef="let cliente">{{ cliente.dataNascimento }}</td>
          </ng-container>

          <ng-container matColumnDef="acoes">
            <th mat-header-cell *matHeaderCellDef>Ações</th>
            <td mat-cell *matCellDef="let cliente">
              <button mat-icon-button>
                <mat-icon>more_vert</mat-icon>
              </button>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      }

      @if (carregando()) {
        <div class="loading-state">
          <mat-spinner diameter="40"></mat-spinner>
          <p>Carregando dados...</p>
        </div>
      }

      @if (!carregando() && clientesRecentes().length === 0) {
        <div class="empty-state">
          <mat-icon>inbox</mat-icon>
          <p>Nenhum cliente cadastrado ainda</p>
          <button mat-raised-button color="primary" (click)="novoCliente()">
            Cadastrar Primeiro Cliente
          </button>
        </div>
      }
    </mat-card-content>
  </mat-card>
</div>